{% extends "shared/layout.html" %}
{% block content %}
<body class="bg-blue-900 font-sans">
  <div class="container mx-auto py-10 px-[10%]">
    <!-- 回上一頁按鈕 -->
    <div class="mb-4">
      <a
        class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded"
        href="javascript:history.back()"
      >
        上一頁
      </a>
    </div>

    <div class="flex bg-white rounded-lg shadow-lg overflow-hidden p-6">
      <!-- 左側為接案者介紹 -->
      <div class="w-2/3">
        <div class="flex items-center mb-6">
          <a href="">
            <img
              src="{% if service.freelancer_user.profile.photo %}{{ service.freelancer_user.profile.photo.url }}{% else %}https://img.daisyui.com/images/stock/photo-1534528741775-53994a69daeb.webp{% endif %}"
              alt="User Avatar"
              class="w-16 h-16 rounded-full mr-4 border-2 border-gray-300 shadow-sm transition-transform duration-300 hover:scale-125 hover:rotate-6"
            />
          </a>
          <div>
            <p class="text-xl font-bold text-gray-800">{{ service.freelancer_user.username }}</p>
            <div class="flex items-center text-yellow-400">
              <span class="text-lg">&#9733;&#9733;&#9733;&#9733;&#9734;</span>
              <span class="text-gray-700 text-base ml-2">4.0/5.0</span>
            </div>
          </div>
        </div>

        <h1 class="text-xl font-bold mb-4 text-gray-800">
          {{ service.title }}
        </h1>

        <div class="flex items-center">
          <img
            src="{% if service.photo %}{{ service.photo.url }}{% else %}https://fakeimg.pl/300{% endif %}"
            alt="Service Image"
            class="w-[80%] h-auto rounded-lg border shadow-sm"
          />
        </div>

        <!-- 接案者介紹:描述 -->
        <p class="text-gray-700 mb-4 text-lg">
          {{ service.description }}
        </p>

        <div class="flex flex-wrap gap-2">
          <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-s">Python</span>
          <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-s">Django</span>
          <span class="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-s">React</span>
          <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-s">HTML5</span>
          <span class="px-3 py-1 bg-pink-100 text-pink-700 rounded-full text-s">CSS3</span>
          <span class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-s">JavaScript</span>
          <span class="px-5 py-1 bg-teal-100 text-teal-700 rounded-full text-s">Web Development</span>
        </div>
        
        <div class="mt-6">
          <h2 class="text-lg font-semibold mb-2">分享此服務</h2>
          <div class="flex space-x-4">
            <a
              href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}"
              target="_blank"
              class="flex items-center justify-center w-10 h-10 bg-blue-600 text-white rounded-full hover:bg-blue-700">
              <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="w-6 h-6" viewBox="0 0 24 24">
                <path
                  d="M22.675 0H1.325C.595 0 0 .6 0 1.35v21.3C0 23.4.595 24 1.325 24h11.49v-9.294H9.691v-3.622h3.123V8.41c0-3.1 1.895-4.788 4.662-4.788 1.325 0 2.462.099 2.793.143v3.24l-1.918.001c-1.504 0-1.795.716-1.795 1.763v2.31h3.587l-.467 3.622h-3.12V24h6.11c.73 0 1.325-.6 1.325-1.35V1.35C24 .6 23.405 0 22.675 0z" />
              </svg>
            </a>

            <a
              href="https://line.me/R/msg/text/?{{ request.build_absolute_uri }}"
              target="_blank"
              class="flex items-center justify-center w-10 h-10 bg-green-500 text-white rounded-full hover:bg-green-600">
              <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="w-6 h-6">
                <title>LINE</title>
                <path
                  d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314" />
              </svg>
            </a>
          </div>
        </div>
      </div>

      <!-- 右側價格一般&專業方案 -->
      <div class="w-1/3 bg-gray-50 p-6 border-l">
        <div class="mb-4">
          <div class="flex border-b">
            <button
              id="standard-tab"
              class="flex-1 py-2 text-center font-semibold text-gray-700 border-b-2 border-blue-600"
            >
              一般方案
            </button>
            <button
              id="premium-tab"
              class="flex-1 py-2 text-center font-semibold text-gray-700 border-b-2"
            >
              專業方案
            </button>
          </div>
        </div>

        <div id="price-section">
          <!-- Standard Plan -->
          <div id="standard" class="block">
            <p class="text-4xl font-bold text-gray-800 mb-2">${{service.standard_price}}</p>
            <p class="text-gray-600 mb-4">
              一般版：{{service.standard_description}} 
            </p>
            <p class="text-sm text-red-500 mb-4">交付時間：{{service.standard_delivery_time}} 天</p>
          </div>

          <!-- Premium Plan -->
          <div id="premium" class="hidden">
            <p class="text-4xl font-bold text-gray-800 mb-2">${{service.premium_price}}</p>
            <p class="text-gray-600 mb-4">
              專業版：{{service.premium_description}} 
            </p>
            <p class="text-sm text-red-500 mb-4">交付時間：{{service.premium_delivery_time}} 天</p>
          </div>
        </div>
        <!-- 支付方式選擇表單 -->
        <form method="post" action="{% url 'order:payment_form_select' service.id %}">
          {% csrf_token %}
          <input type="hidden" name="plan" id="plan" value="standard" />
          <button
            type="submit"
            class="w-full bg-blue-800 text-white py-2 rounded-lg text-lg font-semibold hover:bg-blue-700 text-center block"
          >
            選擇支付方式
          </button>
        </form>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mt-6">
      <h2 class="text-xl font-bold mb-4">留言板</h2>

      <!-- 顯示留言 -->
      {% for comment in comments %}
      <div class="border-b pb-4 mb-4">
        <p class="text-gray-800"><strong>{{ comment.user.username }}</strong></p>
        <p class="text-gray-600">{{ comment.content }}</p>
        <p class="text-sm text-gray-400">{{ comment.created_at|date:"Y-m-d H:i" }}</p>
        {% if comment.user == user %}
        <!-- 刪除留言按鈕 -->
        <form method="POST" action="{% url 'comments:delete_comment' comment.id %}">
          {% csrf_token %}
          <button type="submit" class="text-red-500 text-sm">刪除</button>
        </form>
        {% endif %}
      </div>
      {% empty %}
      <p class="text-gray-500">目前沒有留言，成為第一個留言者吧！</p>
      {% endfor %}

      <!-- 新增留言表單 -->
      <form method="POST" class="mt-6">
        {% csrf_token %}
        <div class="mb-4">
          <label for="content" class="block text-gray-700 font-medium mb-2">留言內容：</label>
          <textarea
            id="content"
            name="content"
            class="w-full h-20 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"
            placeholder="請輸入您的留言內容"
          ></textarea>
        </div>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
          新增留言
        </button>
      </form>
    </div>
  </div>

 {% load static %}
  <script>
    document.addEventListener("DOMContentLoaded", function () {
  const standardTab = document.getElementById("standard-tab");
  const premiumTab = document.getElementById("premium-tab");
  const standardSection = document.getElementById("standard");
  const premiumSection = document.getElementById("premium");

  standardTab.addEventListener("click", function () {
    standardSection.classList.remove("hidden");
    premiumSection.classList.add("hidden");
    standardTab.classList.add("border-blue-600", "text-blue-700");
    premiumTab.classList.remove("border-blue-600", "text-blue-700");
  });

  premiumTab.addEventListener("click", function () {
    premiumSection.classList.remove("hidden");
    standardSection.classList.add("hidden");
    premiumTab.classList.add("border-blue-600", "text-blue-700");
    standardTab.classList.remove("border-blue-600", "text-blue-700");
  });
});
  </script>  
</body>
{% endblock %}
